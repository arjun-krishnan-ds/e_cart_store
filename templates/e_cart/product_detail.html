{% extends 'core/base.html' %}
{% load static %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'e_cart/css/store.css' %}?v=5">
<link rel="stylesheet" href="{% static 'e_cart/css/cart.css' %}?v=7"> {# For toast notifications #}
{% endblock %}

{% block content %}
<div class="container my-5 product-page">

    <div class="row g-5 align-items-start">

        <!-- PRODUCT IMAGE -->
        <div class="col-md-6">
            <img src="{{ product.image.url }}" class="main-product-img w-100 rounded shadow-sm"
                 alt="{{ product.name }}">
        </div>

        <!-- PRODUCT DETAILS -->
        <div class="col-md-6 product-details">

            <h2 class="fw-bold mb-2">{{ product.name }}</h2>
            <p class="product-category text-muted mb-1">
                {{ product.category.name }}
            </p>

            <h3 class="product-price text-success fw-bold mb-3">
                ‚Çπ {{ product.price }}
            </h3>

            <p class="product-description mb-4">
                {{ product.description }}
            </p>

            <!-- ‚úÖ SIMPLIFIED QUANTITY SELECTOR -->
            <div class="qty-wrapper mb-4">
                <label class="fw-semibold mb-1 d-block">Quantity</label>

                <div class="qty-control d-flex align-items-center gap-2" style="max-width:120px;">
                    <button class="qty-btn btn-minus btn-outline-secondary rounded-circle" type="button">‚àí</button>

                    <span id="qty-display" class="qty-display px-3 py-1 rounded border text-center">1</span>

                    <button class="qty-btn btn-plus btn-outline-secondary rounded-circle" type="button">+</button>
                </div>
            </div>

            <!-- ‚úÖ ACTION BUTTONS -->
            <div class="d-flex gap-3 flex-wrap">
                <button class="btn btn-primary btn-lg btn-add-cart" data-id="{{ product.id }}">
                    üõí Add to Cart
                </button>

                <button class="btn btn-success btn-lg btn-buy-now" data-id="{{ product.id }}">
                    ‚ö° Buy Now
                </button>

                <a href="{% url 'product_list' %}" class="btn btn-outline-secondary btn-lg">
                    ‚Üê Back to Products
                </a>
            </div>

        </div>

    </div>
</div>
{% endblock %}

{% block extra_js %}

<!-- ‚úÖ Pass Django URLs safely -->
<script>
    const ADD_CART_URL_PREFIX = "{% url 'add_to_cart' 0 %}".replace("0/", "");
    const CHECKOUT_URL = "{% url 'checkout' %}";
</script>

<script src="{% static 'e_cart/js/store.js' %}?v=5"></script>
{% endblock %}
